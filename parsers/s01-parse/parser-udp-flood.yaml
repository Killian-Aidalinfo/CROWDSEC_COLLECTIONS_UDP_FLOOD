# Parser Configuration File
name: udp-flood-parser
description: "Parser for handling specific UDP stream logs"

filter: "evt.Line.Raw contains 'Handling UDP stream from'"

grok:
  apply_on: message
  pattern: 'time="%{TIMESTAMP_ISO8601:time}" level=%{LOGLEVEL:level} msg="Handling UDP stream from %{IP:source_ip}:%{NUMBER:source_port:int} to %{IP:destination_ip}:%{NUMBER:destination_port:int}"'

statics:
  - meta: log_type
    value: udp-stream-log
  - meta: source_ip
    expression: evt.Parsed.source_ip
  - meta: source_port
    expression: evt.Parsed.source_port
  - meta: destination_ip
    expression: evt.Parsed.destination_ip
  - meta: destination_port
    expression: evt.Parsed.destination_port